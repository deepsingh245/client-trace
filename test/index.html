<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client-Trace Test Suite</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>üõ°Ô∏è Client-Trace Security Suite</h1>
            <p class="subtitle">Interactive Demo & Testing Platform</p>
        </header>

        <!-- Integrity Tests -->
        <section class="test-section">
            <h2>üîê Integrity Verification</h2>
            <div class="test-card">
                <h3>Bundle Integrity Check</h3>
                <p>Verify the integrity of a JavaScript bundle using SHA-256 hashing.</p>
                <div class="button-group">
                    <button id="test-bundle-integrity" class="btn btn-primary">Test Bundle Integrity</button>
                    <button id="test-bundle-tampered" class="btn btn-warning">Test Faulty Bundle (Tampered)</button>
                </div>
                <div id="result-bundle-integrity" class="result"></div>
            </div>
            <div class="test-card">
                <h3>Session Integrity Token</h3>
                <p>Generate a signed session token binding user identity to device context.</p>
                <div class="input-group">
                    <input type="text" id="user-id" placeholder="User ID" value="user-123">
                    <input type="text" id="ip-hash" placeholder="Hashed IP" value="abc123hash">
                    <input type="password" id="secret-key" placeholder="Secret Key" value="my-secret-key">
                </div>
                <div class="button-group">
                    <button id="test-session-token" class="btn btn-primary">Generate Token</button>
                </div>
                <div id="result-session-token" class="result"></div>
            </div>
        </section>

        <!-- Network Tests -->
        <section class="test-section">
            <h2>üåê Network Analysis</h2>
            <div class="test-card">
                <h3>Monkey-Patch Detection</h3>
                <p>Detect if native fetch or XHR APIs have been tampered with.</p>
                <div class="button-group">
                    <button id="simulate-tamper" class="btn btn-warning">Simulate Tampering</button>
                    <button id="detect-tamper" class="btn btn-primary">Detect Tampering</button>
                </div>
                <div id="result-tamper" class="result"></div>
            </div>
            <div class="test-card">
                <h3>Proxy Detection</h3>
                <p>Check for proxy signatures in HTTP headers.</p>
                <div class="button-group">
                    <button id="test-proxy" class="btn btn-primary">Test Proxy Detection</button>
                    <button id="test-proxy-simulate" class="btn btn-warning">Simulate Proxy (Fake)</button>
                </div>
                <div id="result-proxy" class="result"></div>
            </div>
            <div class="test-card">
                <h3>Timing Anomalies</h3>
                <p>Measure network timing to detect potential MITM attacks.</p>
                <div class="button-group">
                    <button id="test-timing" class="btn btn-primary">Test Timing</button>
                </div>
                <div id="result-timing" class="result"></div>
            </div>
        </section>

        <!-- Fingerprinting Tests -->
        <section class="test-section">
            <h2>üîç Fingerprinting & Behavior</h2>
            <div class="test-card">
                <h3>Device Fingerprint</h3>
                <p>Generate a privacy-safe device identifier.</p>
                <div class="button-group">
                    <button id="test-fingerprint" class="btn btn-primary">Generate Fingerprint</button>
                </div>
                <div id="result-fingerprint" class="result"></div>
            </div>
            <div class="test-card">
                <h3>Bot Detection</h3>
                <p>Analyze user behavior (mouse entropy, click speed) to identify automated bots.</p>
                <div class="info-box">
                    <p><strong>How to trigger "Bot Detected":</strong></p>
                    <ul style="text-align: left; margin-bottom: 10px;">
                        <li style="list-style: none;">ü§ñ <strong>Option A (Scripted):</strong> Click "Simulate Bot
                            Movement" to programmatically
                            inject perfect straight-line mouse events.</li>
                        <li style="list-style: none;">‚ö° <strong>Option B (Manual):</strong> Try clicking this box
                            extremely fast (>10 times/sec).
                        </li>
                    </ul>
                </div>
                <div class="button-group">
                    <button id="start-monitor" class="btn btn-success">Start Monitoring</button>
                    <button id="simulate-bot" class="btn btn-warning">Simulate Bot Movement</button>
                    <button id="test-bot" class="btn btn-primary">Detect Bot</button>
                    <button id="stop-monitor" class="btn btn-danger">Stop Monitoring</button>
                </div>
                <div id="result-bot" class="result"></div>
            </div>
        </section>

        <!-- Security Tests -->
        <section class="test-section">
            <h2>üîí Security Monitoring</h2>
            <div class="test-card">
                <h3>Script Injection Detection</h3>
                <p>Monitor for unauthorized script tags and suspicious globals.</p>
                <div class="button-group">
                    <button id="inject-script" class="btn btn-warning">Inject Test Script</button>
                    <button id="detect-injection" class="btn btn-primary">Detect Injections</button>
                </div>
                <div id="result-injection" class="result"></div>
            </div>
            <div class="test-card">
                <h3>CSP Violation Listener</h3>
                <p>Listen for Content Security Policy violations.</p>
                <div class="button-group">
                    <button id="start-csp" class="btn btn-success">Start CSP Listener</button>
                </div>
                <div id="result-csp" class="result"></div>
            </div>
            <div class="test-card">
                <h3>Storage Tampering Detection</h3>
                <p>Detect unauthorized changes to localStorage.</p>
                <div class="button-group">
                    <button id="init-storage" class="btn btn-success">Initialize Storage</button>
                    <button id="tamper-storage" class="btn btn-warning">Tamper Storage</button>
                    <button id="check-storage" class="btn btn-primary">Check Integrity</button>
                </div>
                <div id="result-storage" class="result"></div>
            </div>
        </section>

        <!-- Transport Tests -->
        <section class="test-section">
            <h2>üöÄ Transport Security</h2>
            <div class="test-card">
                <h3>Payload Signing</h3>
                <p>Sign data with HMAC-SHA256 for authenticity.</p>
                <div class="input-group">
                    <textarea id="payload-sign"
                        placeholder='{"event": "login", "user": "john"}'>{"event": "login", "user": "john"}</textarea>
                    <input type="password" id="sign-secret" placeholder="Secret Key" value="my-secret-key">
                </div>
                <div class="button-group">
                    <button id="test-sign" class="btn btn-primary">Sign Payload</button>
                </div>
                <div id="result-sign" class="result"></div>
            </div>
            <div class="test-card">
                <h3>Encrypted Transport</h3>
                <p>Encrypt telemetry using AES-GCM.</p>
                <div class="input-group">
                    <textarea id="payload-encrypt" placeholder='{"sensitive": "data"}'>{"sensitive": "data"}</textarea>
                    <input type="password" id="encrypt-secret" placeholder="Secret Key" value="encryption-key">
                </div>
                <div class="button-group">
                    <button id="test-encrypt" class="btn btn-primary">Encrypt Payload</button>
                </div>
                <div id="result-encrypt" class="result"></div>
            </div>
            <div class="test-card">
                <h3>Nonce-Based Replay Protection</h3>
                <p>Generate and rotate nonces to prevent replay attacks.</p>
                <div class="button-group">
                    <button id="test-nonce" class="btn btn-primary">Get Nonce</button>
                </div>
                <div id="result-nonce" class="result"></div>
            </div>
        </section>

        <!-- Aggregated Report -->
        <section class="test-section">
            <h2>üìä Full Security Report</h2>
            <div class="test-card">
                <h3>Collect Aggregated Security Report</h3>
                <p>Run all security checks and generate a comprehensive report.</p>
                <div class="button-group">
                    <button id="test-full-report" class="btn btn-primary btn-large">Generate Full Report</button>
                </div>
                <div id="result-full-report" class="result"></div>
            </div>
        </section>
    </div>

    <script type="module" src="app.js"></script>
</body>

</html>